---
title: "MtCars-parametrické modelovanie hustoty"
author: "Adam Harmaniak"
date: "2024-11-10"
output: html_document
---

```{r, warning=FALSE}
library(ggplot2)
library(ggExtra)
library(MASS)
library(mvtnorm)

data(mtcars)
str(mtcars)
summary(mtcars)
```

```{r,warning=FALSE}
cor(mtcars$mpg, mtcars$hp)

anova_result <- aov(mpg ~ as.factor(cyl), data = mtcars)
summary(anova_result)

# Rozdelenie dát na dve skupiny podľa hodnoty hp (napríklad nižšie a vyššie ako medián)
mtcars$hp_group <- ifelse(mtcars$hp > median(mtcars$hp), "High HP", "Low HP")

# Bodový graf mpg vs hp, farebne odlíšený podľa skupín
p <- ggplot(mtcars, aes(x = hp, y = mpg, color = hp_group)) +
  geom_point(size = 3, alpha = 0.7) +
  labs(title = "Bodový graf s marginálnou hustotou", x = "Výkon motora (hp)", y = "Spotreba (mpg)") +
  theme_minimal() +
  scale_color_manual(values = c("Low HP" = "blue", "High HP" = "red"))

# Pridanie marginálnej hustoty
ggMarginal(p, type = "density", groupFill = TRUE)
```


```{r,warning=FALSE}
data_subset <- mtcars[, c("mpg", "hp")]

x_seq <- seq(min(data_subset$mpg), max(data_subset$mpg), length.out = 100)
y_seq <- seq(min(data_subset$hp), max(data_subset$hp), length.out = 100)
grid <- expand.grid(x = x_seq, y = y_seq)

densities <- apply(grid, 1, function(point) {
  dmvnorm(point, mean = c(20, 100), sigma = matrix(c(10, 5, 5, 50), ncol = 2)) + 
    dmvnorm(point, mean = c(30, 200), sigma = matrix(c(15, -10, -10, 100), ncol = 2))
})

z_matrix <- matrix(densities, nrow = length(x_seq), ncol = length(y_seq))

plot_ly(
  x = ~x_seq, y = ~y_seq, z = ~z_matrix,
  type = "surface",
  colorscale = "Viridis"
) %>%
  layout(
    title = "3D vizualizácia hustoty s viacerými kopcami",
    scene = list(
      xaxis = list(title = "mpg"),
      yaxis = list(title = "hp"),
      zaxis = list(title = "Density")
    )
  )
```

