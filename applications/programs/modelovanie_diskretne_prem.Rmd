---
title: "Modelovanie dvoch diskrétnych náhodných premenných"
author: "Adam Harmaniak"
date: "2024-11-27"
output: html_document
---

```{r, warning=FALSE}
suppressMessages(suppressWarnings({
  library(ggplot2)
  library(ggmosaic)
  library(plotly)
  library(rgl)
}))

data(mtcars)
```


## Tabuľka
```{r,warning=FALSE}
table(mtcars$cyl, mtcars$carb)
table(mtcars$cyl, mtcars$gear)

prop.table(table(mtcars$cyl, mtcars$carb))
prop.table(table(mtcars$cyl, mtcars$gear))
```


## 2D Vizualizácia
```{r,warning=FALSE}
table_cyl_carb <- as.data.frame(table(mtcars$cyl, mtcars$carb))
names(table_cyl_carb) <- c("Cylinders", "Carburetors", "Count")

ggplot(table_cyl_carb, aes(x = Cylinders, y = Count, fill = Carburetors)) +
  geom_bar(stat = "identity", position = "fill") +
  labs(x = "Počet valcov", y = "Podiel", fill = "Počet karburátorov") +
  theme_minimal()

```


## 3D Vizualizácia
```{r,warning=FALSE}
table_cyl_carb <- as.data.frame(table(mtcars$cyl, mtcars$carb))
names(table_cyl_carb) <- c("Cylinders", "Carburetors", "Frequency")

table_cyl_carb$Probability <- table_cyl_carb$Frequency / sum(table_cyl_carb$Frequency)

table_cyl_carb$Cylinders <- as.numeric(as.character(table_cyl_carb$Cylinders))
table_cyl_carb$Carburetors <- as.numeric(as.character(table_cyl_carb$Carburetors))

fig <- plot_ly()

for (i in 1:nrow(table_cyl_carb)) {
  fig <- fig %>% add_trace(
    x = rep(table_cyl_carb$Cylinders[i], 2),
    y = rep(table_cyl_carb$Carburetors[i], 2),
    z = c(0, table_cyl_carb$Probability[i]),
    type = "scatter3d",
    mode = "lines",
    line = list(color = "blue"),
    showlegend = FALSE
  )
}

fig <- fig %>% add_trace(
  x = table_cyl_carb$Cylinders,
  y = table_cyl_carb$Carburetors,
  z = table_cyl_carb$Probability,
  type = "scatter3d",
  mode = "markers",
  marker = list(size = 5, color = "red"),
  name = "Pravdepodobnosti"
)

fig <- fig %>% layout(
  scene = list(
    xaxis = list(title = "Počet valcov (X)"),
    yaxis = list(title = "Počet karburátorov (Y)"),
    zaxis = list(title = "P(X, Y)")
  )
)

fig

```


